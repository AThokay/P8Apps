(function(m){var y=new Uint16Array([0,15,1015,65535]),c=P8.buffer;c?c.clear():(c=Graphics.createArrayBuffer(240,180,2,{msb:!0}),P8.buffer=c);var w=function(){g.drawImage({width:240,height:180,bpp:2,buffer:c.buffer,palette:y},0,20)};P8.buttons&&TC.removeListener("touch",P8.buttons);if(m){var n=c.getWidth()-9;c.getHeight();var k=Object.keys(m),a=m[""];a&&k.splice(k.indexOf(""),1);a instanceof Object||(a={});a.fontHeight=16;a.x=0;a.x2=n-2;a.y=0;a.y2=179;void 0===a.selected&&(a.selected=0);a.fontHeight||
(a.fontHeight=6);var q=0|a.x,p=a.x2||c.getWidth()-1,l=0|a.y,z=a.y2||c.getHeight()-1;a.title&&(l+=a.fontHeight+2);var f={draw:function(){c.reset();c.setColor(3);c.setFont("6x8",2).setFontAlign(0,-1,0);a.title&&(c.drawString(a.title,(q+p)/2,l-a.fontHeight-2),c.drawLine(q,l-2,p,l-2));for(var b=0|Math.min((z-l)/a.fontHeight,k.length),d=E.clip(a.selected-(b>>1),0,k.length-b),e=l;b--;){var h=k[d],r=m[h];c.setColor(d!=a.selected||f.selectEdit?1:2);c.fillRect(q,e,p,e+a.fontHeight-1);c.setColor(3);c.setFontAlign(-1,
-1);c.drawString(h,q,e);if("object"==typeof r){h=p;var t=r.value;r.format&&(t=r.format(t));f.selectEdit&&d==a.selected&&(h-=25,c.setColor(2),c.fillRect(h-(c.stringWidth(t)+4),e,p,e+a.fontHeight-1),c.setColor(3),c.drawImage("\f\u0005\u0081\x00 \u0007\x00\u00f9\u00f0\u000e\x00@",h,e+(a.fontHeight-10)/2,{scale:2}));c.setFontAlign(1,-1);c.drawString(t,h-2,e)}c.setColor(3);e+=a.fontHeight;d++}c.setFontAlign(-1,-1);c.setColor(d<k.length?-1:0);c.fillPoly([104,172,136,172,120,179]);w()},select:function(b){b=
m[k[a.selected]];if("function"==typeof b)b(f);else if("object"==typeof b){if("number"==typeof b.value)f.selectEdit=f.selectEdit?void 0:b;else if("boolean"==typeof b.value&&(b.value=!b.value),b.onchange)b.onchange(b.value);f.draw()}},move:function(b){if(f.selectEdit){var d=f.selectEdit;d.value-=(b||1)*(d.step||1);void 0!==d.min&&d.value<d.min&&(d.value=d.min);void 0!==d.max&&d.value>d.max&&(d.value=d.max);if(d.onchange)d.onchange(d.value)}else a.selected=(b+a.selected)%k.length,0>a.selected&&(a.selected+=
k.length);f.draw()}},x=[{x1:10,y1:200,x2:59,y2:239,poly:[35,204,20,235,50,235]},{x1:95,y1:200,x2:144,y2:239,poly:[105,204,135,204,105,235,135,235]},{x1:180,y1:200,x2:229,y2:239,poly:[190,204,220,204,205,235]}],u=function(b,d){(d?g.setColor(.8,.8,1):g.setColor(.5,.5,1)).fillRect(b.x1,b.y1,b.x2,b.y2);g.setColor(-1).fillPoly(b.poly)};for(n=0;3>n;n++)u(x[n],!1);var v=function(b,d){var e=x[d],h=b.x>e.x1&&b.y>e.y1&&b.x<e.x2&&b.y<e.y2;h&&(u(e,!0),setTimeout(function(){u(e,!1)},200));return h};P8.buttons=
function(b){v(b,0)?f.move(-1):v(b,1)?f.select():v(b,2)&&f.move(1)};f.draw();TC.on("touch",P8.buttons);return f}w()});